"use strict";(self.webpackChunknovela_blog=self.webpackChunknovela_blog||[]).push([[226],{4613:function(e,t,n){n.r(t),n.d(t,{default:function(){return I}});var a=n(5276),l=n(3942),i=n(8453),r=n(6540);function s(e){const t=Object.assign({p:"p",a:"a",h2:"h2",ul:"ul",li:"li",code:"code",pre:"pre",h3:"h3"},(0,i.R)(),e.components);return r.createElement(r.Fragment,null,r.createElement(t.p,null,r.createElement(t.a,{href:"https://spotbugs.github.io/",target:"_blank",rel:"noreferrer"},"SpotBugs")," is a great tool for static code analysis. Recently I got two similar warnings in one of the codebases I work on\nand I had to fix it."),"\n",r.createElement(t.h2,null,"EI_EXPOSE_REP & EI_EXPOSE_REP2 Warning definitions"),"\n",r.createElement(t.p,null,"You can find the official documentation for these two warnings in the SpotBugs documentation."),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"Warning ",r.createElement(t.a,{href:"https://spotbugs.readthedocs.io/en/stable/bugDescriptions.html#ei-expose-rep",target:"_blank",rel:"noreferrer"},"EI_EXPOSE_REP")),"\n",r.createElement(t.li,null,"Warning ",r.createElement(t.a,{href:"https://spotbugs.readthedocs.io/en/stable/bugDescriptions.html#ei-expose-rep2",target:"_blank",rel:"noreferrer"},"EI_EXPOSE_REP2")),"\n"),"\n",r.createElement(t.h2,null,"EI_EXPOSE_REP"),"\n",r.createElement(t.p,null,"This warning is mainly about exposing a mutable object from a class. Let’s take a class which has a\nmutable object such as a ",r.createElement(t.code,null,"List"),"."),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-java"},"public class MyClass {\n    private List<String> myList;\n\n    public MyClass() {\n        myList = new ArrayList<>();\n    }\n\n    public List<String> getMyList() {\n        return myList;\n    }\n}\n")),"\n",r.createElement(t.p,null,"Now you can see that we are exposing the ",r.createElement(t.code,null,"myList")," object via the ",r.createElement(t.code,null,"getMyList()")," method. This means that anyone who has access to the\n",r.createElement(t.code,null,"MyClass")," object can modify the ",r.createElement(t.code,null,"myList")," object. This is a clear violation of the encapsulation principle in OOP. This is where the\n",r.createElement(t.code,null,"EI_EXPOSE_REP")," warning comes in."),"\n",r.createElement(t.h3,null,"The Fix"),"\n",r.createElement(t.p,null,"We can mainly fix this using two approaches."),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"Return an unmodifiable list from the ",r.createElement(t.code,null,"getMyList()")," method. You can change the getMyList() method as follows."),"\n"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-java"},"public List<String> getMyList() {\n    return Collections.unmodifiableList(myList);\n}\n")),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"Return a copy of the list from the ",r.createElement(t.code,null,"getMyList()")," method. You can change the getMyList() method as follows."),"\n"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-java"},"public List<String> getMyList() {\n    return List.copyOf(myList);\n}\n")),"\n",r.createElement(t.h2,null,"EI_EXPOSE_REP2"),"\n",r.createElement(t.p,null,"This warning is pretty much related to the previous warning. The only difference is that this warning is about keeping\na reference to a mutable object within the class. Let’s take the same example we used in the previous warning."),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-java"},"public class MyClass {\n    private List<String> myList;\n\n    public MyClass(List<String> myList) {  \n        this.myList = myList;\n    }\n}\n")),"\n",r.createElement(t.p,null,"In the above example you can see how the constructor gets a reference to a mutable List from outside the class and assigns it to the\n",r.createElement(t.code,null,"myList")," field. This means that the caller can modify the ",r.createElement(t.code,null,"myList")," object from outside of the class. This is again a clear violation of the\nencapsulation principle and a security risk."),"\n",r.createElement(t.h3,null,"The Fix"),"\n",r.createElement(t.p,null,"The fix for this warning is slightly different from the previous warning. You can fix this by,"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"Creating a copy of the list when assigning it to the ",r.createElement(t.code,null,"myList")," variable."),"\n"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-java"},"public MyClass(List<String> myList) {  \n    this.myList = List.copyOf(myList);\n}\n")),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"Creating an unmodifiable list when assigning it to the ",r.createElement(t.code,null,"myList")," variable."),"\n"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-java"},"public MyClass(List<String> myList) {  \n    this.myList = Collections.unmodifiableList(myList);\n}\n")),"\n",r.createElement(t.h2,null,"Conclusion"),"\n",r.createElement(t.p,null,"These warnings can be really helpful given the right context. But in some cases, it might be an overkill to fix these warnings. So\nit’s always better to analyze the context and decide whether to fix these warnings or not. In case you want to ignore these warnings\nyou can use the ",r.createElement(t.code,null,"@SuppressFBWarnings")," annotation provided by SpotBugs."),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-java"},'@SuppressFBWarnings("EI_EXPOSE_REP")\npublic class MyClass {\n    private List<String> myList;\n\n    public MyClass() {\n        myList = new ArrayList<>();\n    }\n\n    public List<String> getMyList() {\n        return myList;\n    }\n}\n')))}var o,c,u,m,h,g,p,E,d=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,i.R)(),e.components);return t?r.createElement(t,e,r.createElement(s,e)):s(e)},y=n(7350),b=n.n(y),f=n(4794),L=n(1589),w=n(2267),v=n(1110),A=n(5922),x=n(8729),S=n(396),_=n(1601),j=n(6574),M=n(9618),C=n(8947),k=n(9818),P=n(7507),R=n(958);const O=e=>{let{pageContext:t,location:n,children:a}=e;const l=(0,r.useRef)(null),{0:i,1:s}=(0,r.useState)(!1),{0:o,1:c}=(0,r.useState)(0),u=(0,f.useStaticQuery)("1921650733").allSite.edges[0].node.siteMetadata.name,{article:m,authors:h,next:g}=t;return(0,r.useEffect)((()=>{const e=b()((()=>{const t=l.current;if(t){if(!i){const n=(0,S.sg)(e);t.querySelectorAll("img").forEach((e=>{e.complete||(e.onload=n)})),s(!0)}c(t.getBoundingClientRect().height)}}),20);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),r.createElement(L.A,null,r.createElement(k.A,{article:m,authors:h,location:n}),r.createElement(j.A,{article:m,authors:h}),r.createElement(_.A,{contentHeight:o},r.createElement(v.A,{contentHeight:o})),r.createElement(T,null,r.createElement(M.A)),r.createElement(N,{ref:l},r.createElement(w.A,null,r.createElement(P.A),a)),r.createElement(R.A,{pageContext:t}),g.length>0&&r.createElement(X,{narrow:!0},r.createElement(B,null,"More articles from ",u),r.createElement(C.A,{articles:g}),r.createElement(W)))};function I(e){return r.createElement(O,e,r.createElement(d,e))}const T=(0,l.A)("div",{target:"e1rojouh4"})("position:relative;padding-top:60px;transition:background 0.2s linear;text-align:center;",x.A.tablet_up(o||(o=(0,a.A)(["\n    display: none;\n  "]))),";"),N=(0,l.A)("article",{target:"e1rojouh3"})("position:relative;padding:160px 0 35px;padding-left:68px;transition:background 0.2s linear;",x.A.desktop(c||(c=(0,a.A)(["\n    padding-left: 53px;\n  "])))," ",x.A.tablet(u||(u=(0,a.A)(["\n    padding: 70px 0 80px;\n  "])))," ",x.A.phablet(m||(m=(0,a.A)(["\n    padding: 60px 0;\n  "]))),";"),X=(0,l.A)(A.A,{target:"e1rojouh2"})({name:"4zleql",styles:"display:block"}),B=(0,l.A)("h3",{target:"e1rojouh1"})("position:relative;opacity:0.25;margin-bottom:100px;font-weight:400;color:",(e=>e.theme.colors.primary),";",x.A.tablet(h||(h=(0,a.A)(["\n    margin-bottom: 60px;\n  "])))," &::after{content:'';position:absolute;background:",(e=>e.theme.colors.grey),";width:",810/1140*100,"%;height:1px;right:0;top:11px;",x.A.tablet(g||(g=(0,a.A)(["\n      width: ","%;\n    "])),600/1140*100)," ",x.A.phablet(p||(p=(0,a.A)(["\n      width: ","%;\n    "])),400/1140*100)," ",x.A.phone(E||(E=(0,a.A)(["\n      width: 90px\n    "]))),";}"),W=(0,l.A)("div",{target:"e1rojouh0"})({name:"n4muu5",styles:"margin-bottom:65px"})}}]);
//# sourceMappingURL=component---node-modules-sudaraka-94-gatsby-theme-novela-src-templates-article-template-tsx-content-file-path-content-posts-2024-04-29-handling-ei-expose-rep-index-mdx-bdc15c7fb27d001b17a9.js.map